#include<stdio.h>
#include<stdlib.h>

struct node_t {
	int val;
	struct node_t * next;
};
struct node_t * head, * tail;

void print_reverse(const struct node_t * const node){
	if(node == NULL) return;
	print_reverse(node->next);
	printf("%d, ", node->val);
}

int append(struct node_t * node, int value){
	node->next = malloc(sizeof(struct node_t));
	if(node->next == NULL) return 1;
	node->next->val = value;
	node->next->next = NULL;
	return 0;
}

void free_list(struct node_t * list){
	if(list == NULL) return;
	free_list(list->next);
	free(list);
}

int main(int argc, char *argv[])
{
	head = malloc(sizeof(struct node_t));
	head->val = 9;

	tail = head;
	for(int i = 8; i > 0; i--){
		if(append(tail, i)){
			perror("failed to create list\n");
			free_list(head);
			exit(1);
		}
		tail = tail->next;
	}
	print_reverse(head);
	printf("\n");
	free_list(head);
	return 0;
}
